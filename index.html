<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<html>
  <body class="w-screen h-screen">

    <div id="rangeDiv" class="bg-slate-600 h-2/4 w-full">

    </div>

    <script type="module">

      async function getHistory(file) {
        const raw = await d3.json('./datasets/raw/elliot/Streaming_History_Audio_2019-2020_1.json')
        return raw.map( h => {
          h.ts = new Date(h.ts)
          return h
        })
      }


      
      const elliotHistory = await getHistory('./datasets/raw/elliot/Streaming_History_Audio_2019-2020_1.json')

      const groupByDay = d3.groups(elliotHistory, d => d.ts.getDay()+"/"+d.ts.getMonth()+"/"+d.ts.getFullYear())

      groupByDay.forEach(day => {
        const [i, historyOfDay] = day;
        day.msPlayedTotal = d3.sum(historyOfDay, d => d.ms_played);
      });

      console.log(groupByDay)

      //console.log(elliotHistory)

      const rangeSvg =  d3.select("#rangeDiv")
        .append("svg")
        .attr("id", "rangesvg")
        .style("width", "100%")
        .style("height", "100%")
        .style("background-color", "silver")
        
      // https://observablehq.com/@d3/focus-context
      const brush = d3.brushX()
                      .extent(([30, 200]))

      rangeSvg.append("g")
              .call(brush) 






    </script>
    
  </body>
</html> 